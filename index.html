<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Air Quality Monitoring Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <!-- Fonts & premium stylesheet -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <!-- HEADER -->
  <h1> Air Quality Monitor</h1>
<div class="container">
  <header class="topbar">
    <div class="brand">
      <div class="logo">AQ</div>
      <div class="brand-text"><span>Air</span>Quality</div>
    </div>
    <nav class="navlinks">
      <a class="nav-link" href="#">Overview</a>
      <a class="nav-link" href="#map">Map</a>
      <a class="nav-link" href="#">Insights</a>
      <button class="btn-modern btn-cta" id="cta">Upgrade</button>
    </nav>
  </header>

  <!-- HEADER -->
  <h1>ğŸŒ Air Quality Monitor</h1>
  <p class="subtitle">Real-Time Environmental Intelligence</p>

  <!-- STATS -->
  <div class="stats-grid">
    <div class="stat-card aqi">
      <i class="stat-icon fas fa-wind"></i>
      <div class="stat-label">Air Quality Index</div>
      <div class="stat-value" id="mq">--</div>
    </div>

    <div class="stat-card temp">
      <i class="stat-icon fas fa-thermometer-half"></i>
      <div class="stat-label">Temperature</div>
      <div class="stat-value" id="temp">--</div>
    </div>

    <div class="stat-card hum">
      <i class="stat-icon fas fa-droplet"></i>
      <div class="stat-label">Humidity</div>
      <div class="stat-value" id="hum">--</div>
    </div>

    <div class="stat-card status">
      <i class="stat-icon fas fa-circle-check"></i>
      <div class="stat-label">Recommendation</div>
      <div class="stat-value" id="status">--</div>
    </div>
  </div>

  <!-- CONTROLS -->
  <div class="controls-section">
    <select class="form-select" id="mapOption">
      <option value="mq">ğŸ“Š Map by AQI</option>
      <option value="temp">ğŸŒ¡ï¸ Map by Temperature</option>
      <option value="hum">ğŸ’§ Map by Humidity</option>
    </select>
    <button class="btn-modern" onclick="recenterMap()">ğŸ¯ Re-center Map</button>
  </div>

  <!-- LEGEND -->
  <div id="legend" class="legend" aria-hidden="true">
    <div class="legend-group" data-type="mq">
      <div class="legend-item"><span class="chip" style="background:#2ecc71"></span><span class="label">Good (&lt;50)</span></div>
      <div class="legend-item"><span class="chip" style="background:#f1c40f"></span><span class="label">Moderate (50â€“99)</span></div>
      <div class="legend-item"><span class="chip" style="background:#e67e22"></span><span class="label">Unhealthy (100â€“149)</span></div>
      <div class="legend-item"><span class="chip" style="background:#e74c3c"></span><span class="label">Hazardous (&ge;150)</span></div>
    </div>

    <div class="legend-group" data-type="temp">
      <div class="legend-item"><span class="chip" style="background:#60a5fa"></span><span class="label">Cool (&lt;25Â°C)</span></div>
      <div class="legend-item"><span class="chip" style="background:#fb923c"></span><span class="label">Warm (25â€“34Â°C)</span></div>
      <div class="legend-item"><span class="chip" style="background:#ef4444"></span><span class="label">Hot (&ge;35Â°C)</span></div>
    </div>

    <div class="legend-group" data-type="hum">
      <div class="legend-item"><span class="chip" style="background:#60a5fa"></span><span class="label">Low (&lt;40%)</span></div>
      <div class="legend-item"><span class="chip" style="background:#34d399"></span><span class="label">Comfort (40â€“69%)</span></div>
      <div class="legend-item"><span class="chip" style="background:#f59e0b"></span><span class="label">High (&ge;70%)</span></div>
    </div>
  </div>

  <!-- MAP -->
  <div id="map"></div>

</div>

<!-- JS -->
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script>
  /* ğŸ”´ REPLACE WITH YOUR FIREBASE URL */
  const FIREBASE_URL =
  "https://airqualitymapping-feca1-default-rtdb.asia-southeast1.firebasedatabase.app/air_quality/current.json";

  const map = L.map("map").setView([27.7,85.3],13);
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

  let marker=null;

  function getColor(type,val){
    if(type==="mq") return val<50?"green":val<100?"yellow":val<150?"orange":"red";
    if(type==="temp") return val<25?"blue":val<35?"orange":"red";
    if(type==="hum") return val<40?"blue":val<70?"green":"orange";
  }

  function recenterMap(){
    if(marker) map.setView(marker.getLatLng(),15);
  }

  async function fetchData(){
    try{
      const res = await axios.get(FIREBASE_URL);
      const d = res.data;
      if(!d) return;

      document.getElementById("mq").innerText = d.mq ?? "--";
      document.getElementById("temp").innerText = isNaN(d.temp) ? "--" : d.temp+" Â°C";
      document.getElementById("hum").innerText = isNaN(d.hum) ? "--" : d.hum+" %";
      document.getElementById("status").innerText = d.status || "--";

      const type = mapOption.value;
      const value = type==="mq"?d.mq:type==="temp"?d.temp:d.hum;
      const color = getColor(type,value);

      if(marker) map.removeLayer(marker);

      marker = L.circleMarker([d.lat,d.lon],{
        radius:12,
        color:color,
        fillColor:color,
        fillOpacity:0.8
      }).addTo(map);

      marker.bindPopup(`
        <b>AQI:</b> ${d.mq}<br>
        <b>Temp:</b> ${d.temp} Â°C<br>
        <b>Humidity:</b> ${d.hum}%<br>
        <b>Recommendation:</b> ${d.status}
      `);

    }catch(e){
      console.log("Firebase error:",e);
    }
  }

  setInterval(fetchData,2000);
</script>

<script src="script.js"></script>

</body>
</html>

